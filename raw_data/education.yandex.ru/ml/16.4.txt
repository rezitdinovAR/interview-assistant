---
title: Многомерные распределения
url: https://education.yandex.ru/handbook/ml/article/mnogomernye-raspredeleniya
course: ml
chapter: 16. Теормин
chapter_id: 16.4
---
До этого мы рассматривали только одномерные распределения вероятностей на числовой прямой. Однако ничто не мешает в качестве носителя
Ω
Ω выбрать пространство более высокой размерности. И снова все представляющие практический интерес распределения делятся на два класса: дискретные и непрерывные.
Дискретные многомерные распределения
Пусть, например, эксперимент состоит из двух фаз: сначала подбрасывается монетка, а затем кубик. Тогда вероятностная масса сосредоточена в точках
(
i
,
j
)
(i,j),
i
=
0
,
1
i=0,1,
1
⩽
j
⩽
6
1⩽j⩽6. Вероятность каждого исхода можно записать в виде таблицы
«Неудача»
«Успех»
Результат подбрасывания монеты моделирует бернуллиевская случайная величина
ξ
ξ, а результат броска кубика — равномерно распределённая на множестве
{1,2,3,4,5,6} случайная величина
η
η. Содержимое таблицы вероятностей каждого исхода можно также представить матрицей
которая задаёт совместное распределение случайных величин
ξ
ξ и
P(ξ=i,η=j)=P
ij
. Пару случайных величин
(
ξ
,
η
)
(ξ,η) в таком контексте называют также случайным вектором.
Элементы матрицы
P
P не обязаны совпадать; например, монета может быть несимметричной с вероятностью «успеха»
p
p, и тогда таблица вероятностей примет вид
«Неудача»
«Успех»
1
−
p
6
6
1−p
1−p
1−p
1−p
1−p
1−p
p
6
6
p
Контрольный вопрос. Какая таблица вероятностей соответствует эксперименту, в котором результат подбрасывания монеты «портит» кубик следующим образом: на нём могут равновероятно выпасть только значения
1
1 или
2
2 в случае «неудачи» и
4
4,
5
5 или
6
6 в случае «успеха»?
В общем случае дискретное
n
n-мерное распределение задаётся многомерным тензором из неотрицательных чисел
, суммирующихся в единицу. Такие тензоры используются для задания совместного распределения вероятностей случайного вектора
,…,ξ
n
) из дискретных случайных величин:
P(ξ
,…,ξ
n
=i
n
)=p
Непрерывные многомерные распределения
Непрерывное распределение на плоскости задаётся плотностью
p(x,y)⩾0; при этом вероятность события
A
⊂
R
2
A⊂R
2
равна
P(A)=
A
∬
p(x,y)dxdy
при условии, что этот интеграл имеет смысл. Простейший пример — равномерное распределение на единичном квадрате
[0,1]
2
: его плотность равна
[0,1]
2
(x,y), и
для
P(A)=
A
∬
dxdy=∣A∣ для A⊂[0,1]
2
.
Именно так на единичном квадрате формально определяется геометрическая вероятность.
Плотность непрерывного распределения в
R
n
R
n
является неотрицательной функцией вида
p(x
1
,…,x
n
) со свойством
p(x
1
,…,x
n
)dx
1
…dx
n
=1.
Говорят, что случайный вектор
ξ=(ξ
1
,…,ξ
n
) имеет совместную плотность
,…,x
n
), если
P(ξ∈A)=
A
∫
p(x
1
,…,x
n
)dx
1
…dx
n
для всех достаточно «хороших» (измеримых по Лебегу) множеств
A
⊂
R
n
A⊂R
n
.
Маргинальные распределения
Из совместного распределения можно получить распределение в пространстве меньшей размерности путём суммирования или интегрирования по части переменных. Например, если матрица
P
i
j
P
ij
задаёт совместное распределение случайных величин
ξ
ξ и
=P(ξ=i,η=j), то каждый из наборов чисел
неотрицателен и суммируется в единицу:
i,j
∑
P
ij
=1.
Таким образом, числа
} и
} задают некоторые распределения вероятностей, называемые маргинальными.
Упражнение. Найдите маргинальные распределения, если совместное распределение задано матрицей
а) (
6
1−p
6
p
6
1−p
6
p
6
1−p
6
p
6
1−p
6
p
6
1−p
6
p
6
1−p
б) (
В непрерывном случае ситуация похожая: если случайный вектор имеет совместную плотность
p(x,y), то функции
q(x)=
−∞
∫
∞
p(x,y)dy,r(y)=
−∞
∫
∞
p(x,y)dx
являются плотностями маргинальных распределений.
Для
n
n-мерных распределений можно находить маргинальные распределения, суммируя или интегрируя по любым наборам переменных с индексами
1⩽i
1
<i
2
<…<i
k
⩽n; в результате получится маргинальное распределение по оставшимся
n
−
k
n−k переменным.
Независимость случайных величин
Случайные величины
ξ
ξ и
η
η называются независимыми, если совместное распределение случайного вектора
(
ξ
,
η
)
(ξ,η) распадается на произведение одномерных. Точнее говоря,
дискретные случайные величины
ξ
ξ и
η
η независимы, если
P(ξ=x
i
,η=y
j
)=P(ξ=x
i
)P(η=y
j
) для всех возможных
непрерывные случайные величины
ξ
ξ и
η
η независимы, если их совместная плотность
p(x,y)=p
ξ
(x)p
η
(y).
Если случайные величины
ξ
ξ и
η
η независимы, то распределение каждой из них является маргинальным распределением их совместного распределения, поскольку
P(ξ=x
i
)P(η=y
j
)=P(η=y
P(ξ=x
i
)P(η=y
j
)=P(ξ=x
(x)p
η
(y)dx=p
η
(y),
(x)p
η
(y)dy=p
ξ
(x).
Случайные величины
,…,ξ
n
) независимы в совокупности, если их совместное распределение (совместная плотность) распадается в произведение одномерных распределений (плотностей).
Пример. Рассмотрим
n
n гауссовских случайных величин
∼N(μ
k
,σ
k
2
) с плотностями
Совместную плотность случайного вектора
ξ=(ξ
1
,…,ξ
n
) определим как произведение плотностей его компонент:
,…,x
n
)=p
ξ
1
(x
1
)…p
ξ
n
(x
n
)=
(2π)
n/2
k=1
Случайный вектор
ξ
ξ с такой плотностью имеет многомерное нормальное (гауссовское) распределение c независимыми в совокупности компонентами. Любое маргинальное распределение случайного вектора
ξ
ξ обладает плотностью того же вида, и поэтому также является гауссовским.
Характеристики случайных векторов
Математическое ожидание случайного вектора
ξ=(ξ
1
,…,ξ
n
) является вектором той же размерности и вычисляется покомпонентно:
Eξ=(Eξ
1
,…,Eξ
n
).
Каждая компонента случайного вектора — это обычная случайная величина, и её среднее можно вычислить стандартными методами:
,…,i
в дискретном случае;
p(x
1
,…,x
n
),dx
1
…dx
n
в непрерывном случае.
Математическое ожидание перестановочно с линейным преобразованием случайного вектора:
E(Cξ)=CEξ, где
C
C — фиксированная матрица.
Вместо дисперсии у случайного вектора
ξ=(ξ
1
,…,ξ
n
) есть матрица ковариаций:
Vξ=cov(ξ,ξ)=E(ξ−Eξ)(ξ−Eξ)
T
.
Матрица ковариаций симметрична и состоит из попарных ковариаций компонент случайного вектора
cov(ξ,ξ)
ij
=cov(ξ
i
,ξ
j
).
Упражнение. Докажите, что ковариационная матрица любого случайного вектора неотрицательно определена.
Если случайные величины
,…,ξ
n
независимы в совокупности, то
cov(ξ
i
,ξ
j
)=0, и ковариационая матрица случайного вектора
ξ=(ξ
1
,…,ξ
n
) диагональна:
cov(ξ,ξ)=diag{Vξ
1
,…,Vξ
n
}.
Например, матрица ковариации гауссовского случайного вектора
ξ
ξ с плотностью
,…,x
n
)=
(2π)
n/2
k=1
k=1
равна
diag{σ
1
2
,…,σ
n
2
}, поскольку компоненты вектора
ξ
ξ независимы в совокупности и имеют нормальное распределение
N(μ
k
,σ
k
2
).
Аналогом ковариации в многомерном случае служит матрица ковариаций между случайными векторами
ξ=(ξ
1
,…,ξ
n
) и
η=(η
1
,…,η
cov(ξ,η)=E(ξ−Eξ)(η−Eη)
T
.
Матрицу ковариаций можно также вычислить по формуле
cov(ξ,η)=Eξη
T
−Eξ(Eη)
T
.
Упражнение. Пусть случайный вектор
η
η получен из случайного вектора
ξ
ξ линейным преобразованием:
η
=
Cξ
η=Cξ. Как связаны между собой их ковариационные матрицы?
Преобразования плотностей случайных векторов
Нередко приходится иметь дело не с самими случайными векторами, а с функциями от них. Но как найти плотность случайного вектора
η=g(ξ), зная плотность
(x)?
Предположим, что
g:R
n
→R
n
— гладкая обратимая функция. Тогда для измеримого
A
⊂
R
n
A⊂R
n
имеем
P(η∈A)=P(g(ξ)∈A)=P(ξ∈g
−1
(A))=
g
−1
(A)
∫
p
ξ
(x)dx
Чтобы перейти к интегралу по
A
A, сделаем замену переменной
x=g
−1
(z). По формуле замены координат в кратном интеграле получаем
det
(A)
∫
p
ξ
(x)dx=
(z))∣detJ(z)∣dz,
где
det
⁡
J
(
z
)
detJ(z) – якобиан преобразования
(z), т.е. определитель матрицы Якоби
J(z)=
∂z
∂g
−1
(z)
.
Таким образом,
det
(z)=p
ξ
(g
−1
(z))∣detJ(z)∣.
Упражнение. Пусть
ξ
ξ – случайный вектор с плотностью
(x). Какова плотность случайного вектора
η
=
μ
+
Cξ
η=μ+Cξ, где
μ
μ – постоянный вектор, а
C
C – постоянная обратимая матрица?
Распределение суммы независимых случайных величин
В дискретном случае найти распределение суммы двух независимых случайных величин несложно. В самом деле,
P(ξ+η=k)=
i
∑
P(ξ+η=k,η=i)=
i
∑
P(ξ=k−i,η=i).
В силу независимости случайных величин
ξ
ξ и
η
η последняя сумма равна
P(ξ=k−i)P(η=i).
Полученная формула называется формулой свёртки.
Пусть теперь
– независимые непрерывные случайные величины с плотностями
(x) и
(x) соответственно. Сам собой напрашивается аналог формулы свёртки с плотностями вместо вероятностей, но чтобы достаточно строго вывести его и не запутаться, мы немного схитрим. А именно, мы рассмотрим случайный вектор
ξ=(ξ
1
,ξ
2
)
T
и его (обратимое!) преобразование
g(ξ)=(
)=(
1
0
1
1
)ξ=:η=(
η
1
η
2
).
Обратное к нему будет иметь вид
h(η)=(
1
0
−1
1
)η=(
Тогда по правилу преобразования плотности
det
(z)=
=1
det(
)=p
где в последнем равенстве мы воспользовались независимостью
. Распределение случайной величины
– это маргинальное распределение, которое вычисляется следующим образом:
(y)=
(y−x)p
ξ
2
(x)dx.
Эта формула также называется формулой свёртки.
Примеры многомерных распределений
Рассмотрим несколько популярных распределений случайных векторов.
Мультиномиальное распределение
Биномиальное распределение
Bin(n,p) моделирует
n
n-кратное подбрасывание монеты с вероятностями «успеха»
p
p и «неудачи»
q
=
1
−
p
q=1−p. Мультиномиальное распределение обобщает этот эксперимент: теперь подбрасывается кубик с
k
⩾
2
k⩾2 гранями, и вероятность выпадения
i
i-й грани равна
i=1
∑
k
p
i
=1. Обозначим через
ξ
i
ξ
i
количество выпадений
i
i-й грани в серии из
n
n бросков. Тогда случайный вектор
ξ=(ξ
1
,…,ξ
k
) имеет мультиномиальное распределение, при котором
P(ξ
1
=m
1
,…,ξ
!⋅…⋅m
⋅…⋅p
i=1
∑
k
m
i
=n.
При
n
=
1
n=1 мультиномиальное распределение превращается в категориальное, известное также под названием multinoulli. Категориальное распределение моделирует случайный выбор одного из
k
k классов с заданными вероятностями
,…,p
k
).
Многомерное нормальное распределение
Многомерное нормальное (гауссовское) распределение задаётся функцией плотности
det
⁡
Σ
exp
p(x)=
(2π)
n/2
detΣ
1
exp(−
2
1
(x−μ)
T
Σ
−1
(x−μ)),
где
x,μ∈R
n
,
Σ
Σ — невырожденная симметричная матрица размера
n
×
n
n×n. Такое распределение обозначается
N(μ,Σ).
Если случайный вектор
ξ∼N(μ,Σ), то
E
ξ
=
μ
Eξ=μ,
cov(ξ,ξ)=Σ; таким образом, параметры гауссовского распределения — это его среднее и матрица ковариаций.
Упражнение. Пусть
ξ∼N(μ,Σ) и
η
=
Aξ
+
b
η=Aξ+b. Докажите, что
AΣA
T
)
η∼N(Aμ+b,AΣA
T
).
Важный частный случай случайного гауссовского вектора с независимыми компонентами был рассмотрен в примере из секции про независимость случайных величин. Такое распределение получается, если матрица
Σ
Σ диагональна,
Σ=diag{σ
1
2
,…,σ
n
2
}. Тогда
det
detΣ
=diag{
σ
1
2
1
,…,
σ
n
2
1
}, и поэтому
(x−μ)
T
Σ
−1
(x−μ)=−
2
1
k=1
Отсюда снова получаем формулу совместной плотности
(x)=
(2π)
n/2
k=1
которую можно переписать в виде
k=1
k=1
),ξ
k
∼N(ξ
k
,σ
k
2
),
откуда следует независимость в совокупности компонент вектора
ξ
ξ.
Если ковариационная матрица
Σ
Σ не является диагональной, то отдельные компоненты случайного вектора
ξ∼N(μ,Σ) зависимы. Тем не менее, всегда найдётся линейное (и даже ортогональное) преобразование, которое превратит вектор
ξ
ξ в гауссовский вектор с независимыми компонентами. Для этого достаточно найти ортогональную матрицу
Q
Q со свойством
QΣQ
T
=diag{σ
1
2
,…,σ
n
2
},
и далее воспользоваться формулой плотности линейного преобразования гауссовского вектора.
По тем же соображениям облако точек, сгенерированных из распределения
N(μ,Σ), будет напоминать эллипсоид с полуосями, пропорциональными вектору
,…,σ
n
2
). Линии уровня плотности
p
(
x
)
p(x) задаются уравнениями вида
p(x)=C, а такое равенство эквивалентно квадратичной форме
(x−μ)
T
Σ
−1
(x−μ)=C
1
,
где
C
C и
C
1
C
1
– некоторые константы. С помощью описанной выше ортогональной замены эта квадратичная форма может быть приведена к главным осям:
z=C
2
,Λ=diag{σ
1
2
,…,σ
n
2
};
в координатах это выглядит как
l=1
Мы получили практически каноническое уравнение
n
n-мерного эллипсоида. В
R
2
R
2
это будут эллипсы, сплюснутые тем сильнее, чем дальше от единицы отношение
собственных значений матрицы
Σ
Σ.
Нормальным будет и всякое маргинальное распределение многомерного гауссовского вектора.
Упражнение. Пусть случайный вектор
ξ=(ξ
1
,ξ
2
) имеет гауссовское распределение с параметрами
μ=(
μ
1
μ
2
),Σ=(
где
n−k
∈Mat
k×k
∈Mat
k×(n−k)
∈Mat
(n−k)×(n−k)
.
Докажите, что случайный вектор
ξ
1
ξ
1
, полученный маргинализацией по компонентам вектора
ξ
2
ξ
2
, является гауссовским с параметрами
Распределение Дирихле
Распределение Дирихле сосредоточено на
K
K-мерном симплексе
{(x
1
,…,x
K
):x
1
+…+x
K
=1,x
i
⩾0}.
Плотность распределения Дирихле
Dir(α) равна
p(x
1
,…,x
K
)=
B(α)
1
i=1
где
α=(α
1
,…,α
K
) – вектор положительных параметров, а
B(α)=
Γ(∑
Γ(α
i
)
– многомерная бета-функция. Если
ξ∼Dir(α),
Eξ=
α
0
α
,cov(ξ
+1)
k=1
∑
K
α
k
.
Знак вопроса
Пройдите квиз по параграфу
Чтобы закрепить пройденный материал
Сообщить об ошибке
Предыдущий параграф
16.3. Вероятностные распределения
Следующий параграф
16.5. Независимость и условные распределения вероятностей
