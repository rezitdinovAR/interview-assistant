---
title: Implicit bias
url: https://education.yandex.ru/handbook/ml/article/implicit-bias
course: ml
chapter: 13. Теория глубокого обучения
chapter_id: 13.6
---
Под термином implicit bias мы будем понимать явление, состоящее в том, что алгоритм обучения среди всех возможных моделей с нулевым эмпирическим риском выбирает определённые. Это явление можно наблюдать уже на очень простом примере. Рассмотрим задачу линейной регрессии с квадратичной функцией потерь. Пусть имеется
m
m обучающих примеров в евклидовом пространстве размерности
N
>
m
N>m. В этом случае наша задача
min
⁡
w
2
1
∥Xw−y∥
2
2
→min
w
недоопределена: семейство решений составляет линейное многообразие в пространстве весов. Предположим, что матрица объекты-признаки
X∈R
m×N
имеет полный ранг по строкам:
rkX=m<N.
Рассмотрим динамику градиентного спуска с шагом
η
η и нулевой инициализацией весов:
k+1
=w
k
+ηX
T
(y−Xw
k
),w
0
=0.
Нам будет удобнее вместо дискретного градиентного спуска рассматривать его непрерывный аналог
(y−Xw),w(t)=0,
переход к которому соответствует стремлению
η
η к нулю и выбору параметризации по
t
t, для которой
k=[t/η] (округление берётся в любую сторону).
Рассмотрим сингулярное разложение
X=UΣV
T
, где
U
U и
V
V ортогональны, а
Σ
Σ – прямоугольная диагональная матрица. Тогда
X=VΣ
T
ΣV
T
∈R
N×N
rk(X
T
X)=m.
Обозначая
w и
y=Σ
T
U
T
y, получаем:
(0)=0.
В координатном виде имеем следующее:
(0)=0∀i∈[1:m]
=0,
w
~
i
(0)=0∀i∈[m+1:N]
так как
Σ
T
Σ
Σ
T
Σ – диагональная матрица, у которой лишь первые
m
m элементов на диагонали не равны нулю, и у вектора
y тоже лишь первые
m
m координат ненулевые.
Так как все
σ
i
σ
i
для
i=1,…,m ненулевые, при
t
→
∞
t→∞ получаем следующее решение:
(∞)=
∀i∈{1,…,m},
w
~
i
(∞)=0∀i∈{m+1,…,N}.
Это можно записать в эквивалентном матричном виде:
(∞)=(Σ
y, где «+» обозначает взятие псевдообратной матрицы.
Значит,
w(∞)=VΣ
+
U
T
y=X
+
y=X
T
(XX
T
)
−1
y в силу того, что матрица
X
X имеет полный ранг по строкам.
Покажем теперь, что это частное решение, найденное градиентным спуском с нулевой инициализацией, имеет наименьшую евклидову норму среди всех минимумов функции потерь
∣∣Xw−y∣∣
2
2
.
Рассмотрим соответствующую функцию Лагранжа:
L(w;λ)=
2
∥w∥
2
2
+λ
T
(y−Xw).
Здесь
λ
∈
R
m
λ∈R
m
. Покажем, что пара
(w(∞),λ
∗
=(XX
T
)
−1
y) является критической точкой этой функции:
L(w(∞);λ
∗
)=y−Xw(∞)=y−XX
T
(XX
T
)
−1
y=0;
L(w(∞);λ
∗
)=w(∞)−X
T
λ
∗
=X
T
((XX
T
)
−1
y−(XX
T
)
−1
y)=0.
В силу выпуклости функции Лагранжа эта критическая точка является точкой глобального минимума.
Случай линейных сетей
Каков implicit bias нейронных сетей? Сходится ли градиентный спуск в решение наименьшей нормы и если да, то о какой норме идёт речь? Частичный ответ на этот вопрос удаётся получить для линейных сетей.
Следуя работе Exact solutions to the nonlinear dynamics of learning in deep linear neural networks, рассмотрим линейную сеть с одним скрытым слоем:
f(x;W
1:2
)=W
2
W
1
x,
где
– матрицы
n
×
n
n×n.
Поставим задачу многомерной (метка
y
y – вектор) регрессии с квадратичной функцией потерь:
min
⁡
W
L(W
1:2
)=E
x,y
∣∣y−f(x;W
1:2
)∣∣
2
2
→
W
min
Шаг градиентного спуска выглядит следующим образом:
=ηE
x,y
W
2
T
(yx
=ηE
x,y
(yx
где точка над
W
i
W
i
означает производную по времени (то есть по
t
t).
Это нелинейная система матричных дифференциальных уравнений второго порядка; чтобы проинтегрировать её аналитически, нам придётся сделать ряд предположений.
Определим ковариационную матрицу входов
=Exx
T
и матрицу ковариации меток со входами
=Eyx
T
. Предположим, что данные декоррелированы:
=I; этого можно добиться, заменив входы
x
x на
x. Что касается матрицы ковариации меток со входами, рассмотрим её сингулярное разложение:
2,0
V
0
T
=
r=1
Назовём
s
r
s
r
силой моды с индексом
r
r ковариации между метками и входами.
Сделаем замену координат:
В новых координатах градиентный спуск принимает вид:
2,0
=η(S
2,0
Пусть
=[a
1
,…,a
n
] и
=[b
1
,…,b
n
]
T
. Тогда в терминах векторов
a
a и
γ=1
)=(s
α
−(b
α
T
a
α
))b
γ=1
=(s
α
−(a
α
T
b
α
))a
Получилась система векторных дифференциальных уравнений порядка
2
n
2n, всё ещё нелинейная. К счастью, при определённом предположении об инициализации эта система распадается на
n
n независимых систем порядка
2
2.
Предположим, что существует ортогональная матрица
R=[r
1
,…,r
n
], такая что при всех
α
α имеет место равенство
(0)=
a
~
(0)r
(0)=
b
~
(0)r
α
для некоторых скалярных величин
(0) и
(0).
Нетрудно заметить, что в этом случае при всех
α
α и в любой момент времени
t
t имеем
(t)=
a
~
(t)r
(t)=
b
~
(t)r
α
для некоторых скалярных величин
(t) и
(t) .
Тогда для различных
α
α выражения выше становятся независимыми друг от друга:
=η(s−
=η(s−
Теперь это система нелинейных дифференциальных уравнений второго порядка.
Если
в начальный момент, то это верно и в любой момент времени. Тогда система выше превращается в одно уравнение первого порядка.
В самом деле, обозначив
, получаем:
=2η(s−u)u.(1)
Это уравнение задаёт следующую динамику градиентного спуска для функции потерь
E(u)=
2
1
(s−u)
2
(её глобальный минимум – это
u
=
s
u=s).
Перед тем, как интегрировать уравнение (1), напомним, как из
u
u перейти обратно к исходным
. Имеем для
,…,
Аналогично для
,…,
Теперь проинтегрируем уравнение (1) в предположении, что
u(0)=u
u(t)=u
f
для выбранного
2u(s−u)
du
du=
2sη
s−u
du
)du=
2sη
1
(ln(
u
0
u
f
)−ln(
))=
2sη
1
ln(
u
0
(u
f
−s)
u
f
(u
0
−s)
).
Рассмотрим время, необходимое, чтобы выучить фиксированную долю силы данной моды
=ξs, где
ξ∈(0,1), стартуя из точки из окрестности нуля
=ϵ. Оно равняется
(ξ)
=
2sη
1
ln(
1−ξ
ξ
ϵ
s−ϵ
)=
2sη
1
(ln(s/ϵ−1)−ln(ξ
−1
−1)).
Видим, что чем сильнее мода (то есть чем больше
s
s), тем быстрее она сходится.
Рассмотрим две моды с силами
, такие что
. Насколько вторая (более слабая) мода выучится к моменту, когда первая уже выучится на долю
ξ
ξ? Из уравнения выше имеем:
−s)
u
f
(u
0
−s)
=e
2sηt
=(1−
u
0
s
)e
−2sηt
.
Подставляя
s
=
s
2
s=s
t=t
1
(ξ)
, получаем:
=(1−
ϵ
s
2
)e
−2s
2
ηt
1
(ξ)
=(1−
(ln(s/ϵ−1)−ln(ξ
−1
−1))
1−ξ
=−s
1−ξ
Поскольку
, это выражение стремится к минус бесконечности при
ϵ
→
0
ϵ→0, из чего следует, что
u
f
u
f
стремится к нулю.
Это означает, что если веса в инициализации лежат в окрестности нуля, то к моменту, когда данная мода выучивается на любую фиксированную долю
ξ∈(0,1), более слабые моды не успевают выучиться вообще. Таким образом, в любой момент времени
t
t матрица
(t)W
1
(t) является наилучшим малоранговым приближением заданного ранга матрицы корреляций
Σ
y
x
Σ
yx
, причём чем больше
t
t, тем больше ранг. Можно сказать, что градиентный спуск с фиксированным числом шагов «предпочитает» решения малого ранга.
В выводе выше, мы использовали ряд предположений, в частности, что вектора
a
1
:
n
a
1:n
, образующие матрицу
W
1
‾
W
1
, ортогональны в инициализации. Эмпирически те же выводы оказываются верными и без этого предположения, см. графики в оригинальной работе Exact solutions to the nonlinear dynamics of learning in deep linear neural networks. Можно ли их обосновать строго математически? В работах Towards resolving the implicit bias of gradient descent for matrix factorization и Deep Linear Networks Dynamics доказывается, что самая сильная мода выучивается в первую очередь. Тем не менее, на момент написания этого текста остаётся недоказанным, что все моды выучиваются последовательно от сильных к слабым. К сожалению, implicit bias градиентного спуска для нелинейных сетей пока остаётся почти неизученным.
Знак вопроса
Пройдите квиз по параграфу
Чтобы закрепить пройденный материал
Сообщить об ошибке
Предыдущий параграф
13.5. Ландшафт функции потерь
Следующий параграф
14.1. Оптимизация в ML
Как найти оптимум функции потерь: от градиентного спуска до Adam
