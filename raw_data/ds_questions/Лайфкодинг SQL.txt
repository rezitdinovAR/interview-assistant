30.11.2025, 20:08

Лайфкодинг SQL

Карьерная платформа

Лайфкодинг SQL

Задачи

Задача №1

Пусть имеем таблицу с 3 столбцами: id, name и age, которая содержит 100

Допустим, неизвестно, является ли id первичным ключом таблицы.

Хотим проверить, так ли это. Каким простым запросом можно сделать такую

Допустим, нужно добавить в эту таблицу столбец с количеством раз, котор

встречается в таблице. Как это сделать? Допустим, нужно определить возр

который чаще всего встречается в таблице.

Как это сделать?





Посмотреть ответ

Ответ

Решение:

Для проверки, является ли столбец id первичным ключом таблицы, можно выполнить

https://gernar.ru/plus/questions/14bee738-d69b-8186-bf12-fd1a79a687d5

1/7

30.11.2025, 20:08

Лайфкодинг SQL

запрос, который проверяет, есть ли в столбце id уникальные значения для каждой строки: SELECT COUNT(id) AS total_rows, COUNT(DISTINCT id) A FROM your_table_name;







Если количество строк в столбце id ( total_rows ) равно количеству уникальных значений

( distinct_ids ), то можно предположить, что

столбец id является первичным ключом.

Чтобы добавить столбец с количеством раз, которое каждое имя встречается в таблице, можно использовать следующий запрос: ALTER TABLE your_table_name

ADD COLUMN name_count INT;

UPDATE your_table_name

SET name_count = (SELECT COUNT(*) FROM your_table_na







Этот запрос добавляет новый столбец name_count в

таблицу и затем обновляет его значения, подсчитывая количество строк с каждым именем.

Чтобы определить возраст, который чаще всего

встречается в таблице, можно использовать

следующий запрос:

SELECT age

FROM your_table_name

GROUP BY age

ORDER BY COUNT(*) DESC

LIMIT 1;

https://gernar.ru/plus/questions/14bee738-d69b-8186-bf12-fd1a79a687d5

2/7





30.11.2025, 20:08

Лайфкодинг SQL



Этот запрос группирует строки по возрасту, считает

количество строк для каждого возраста, затем

сортирует результаты по убыванию количества

строк и выбирает самый часто встречающийся

возраст.

Задача №2

Для каждого клиента вычислить средний интервал между заказами в днях, и

Таблица order содержит следующие столбцы:

- order_id: уникальный идентификатор заказа.

- date_time: дата и время заказа.

- amount: сумма заказа.

- customer_id: идентификатор клиента, связанный с заказом.

Таблица customer содержит следующие столбцы:

- customer_id: уникальный идентификатор клиента.

- age: возраст клиента.

Для каждого клиента необходимо вычислить средний интервал между его зак





Посмотреть ответ

Ответ

Для вычисления среднего интервала между заказами

для каждого клиента, мы можем сделать следующее: 1. Сначала мы объединим таблицы order и

customer по столбцу customer_id , чтобы

получить информацию о клиенте и его заказах.

2. Затем мы вычислим разницу в днях между

каждым заказом для каждого клиента.

3. Наконец, мы сгруппируем результаты по

customer_id и вычислим среднее значение

интервала для каждого клиента.



Вот как это можно сделать в SQL: SELECT

c.customer_id,

AVG(DATEDIFF(o1.date_time, o2.date_time)) AS avg https://gernar.ru/plus/questions/14bee738-d69b-8186-bf12-fd1a79a687d5

3/7





30.11.2025, 20:08

Лайфкодинг SQL

FROM

customer c

JOIN

òrderò1 ON c.customer_id = o1.customer_id JOIN

òrderò2 ON c.customer_id = o2.customer_id WHERE

o1.date_time > o2.date_time GROUP BY

c.customer_id;



Этот запрос соединяет таблицы order и customer по столбцу customer_id , затем вычисляет разницу в

днях между каждым заказом для каждого клиента 

( DATEDIFF(o1.date_time, o2.date_time) ), и наконец, сгруппирует результаты по customer_id и вычислит

среднее значение разницы дней для каждого

клиента.

Задача №3

Предложить SQL запрос для оценки качества данных в динамике по заполнен

В таблице table есть отчётные даты report_dt на конец месяца, номера до

Названия полей по которым анализируем пропуски: feature1, feature2.

Вид таблицы: table(report_dt, id, feature1, feature2) Пример строки:

'2024-01-31', 457294, 1, Null

'2024-02-28', 784934, Null, 3





Посмотреть ответ

Ответ

Решение:

SELECT

report_dt,

COUNT(id) AS total_records,

https://gernar.ru/plus/questions/14bee738-d69b-8186-bf12-fd1a79a687d5

4/7





30.11.2025, 20:08

Лайфкодинг SQL

COUNT(feature1) AS filled_feature1, COUNT(feature2) AS filled_feature2, 1 - (COUNT(feature1) / COUNT(id)) AS feature1_co 1 - (COUNT(feature2) / COUNT(id)) AS feature2_co FROM

table

GROUP BY

report_dt

ORDER BY

report_dt;

Задача №4





-- Вот условие задания:

CREATE TABLE shop (

id SERIAL PRIMARY KEY, name VARCHAR(255) NOT NULL, city VARCHAR(255) NOT NULL

);

CREATE TABLE cheque (

uid UUID NOT NULL DEFAULT gen_random_uuid(), created_at TIMESTAMP NOT NULL DEFAULT now(),

"sum" DECIMAL(10, 2) NOT NULL, shop_id INT NOT NULL, customer_id BIGINT NOT NULL, PRIMARY KEY (uid),

FOREIGN KEY (shop_id) REFERENCES shop (id)

);

-- Вот само задание, которое нужно решить:

-- Вывести средний чек для покупателя за последнюю неделю,

-- когда у него была покупка:

-- покупатель - средний чек - дата последней покупки.





Посмотреть ответ

Ответ

Решение:

SELECT

c.customer_id,

AVG(ch."sum") AS average_check, https://gernar.ru/plus/questions/14bee738-d69b-8186-bf12-fd1a79a687d5

5/7





30.11.2025, 20:08

Лайфкодинг SQL

MAX(ch.created_at) AS last_purchase_date FROM

cheque ch

JOIN

(

SELECT

customer_id,

MAX(created_at) AS max_purchase_date FROM

cheque

WHERE

created_at >= CURRENT_DATE - INTERVAL '7

GROUP BY

customer_id

) AS max_dates ON ch.customer_id = max_dates.cus JOIN

shop s ON ch.shop_id = s.id

GROUP BY

c.customer_id;

Задача №5





Есть две таблицы А=10 строк В=50 строк какое максимальное и минимальное





Посмотреть ответ

Ответ

Решение:

При выполнении операции left join (или left outer join ) в SQL, результат будет содержать все

строки из таблицы A, даже если в таблице B нет

соответствующих строк.

Таким образом, минимальное количество строк в

результирующей таблице будет равно количеству

строк в таблице A, то есть 10 строк.

Максимальное количество строк в результирующей

https://gernar.ru/plus/questions/14bee738-d69b-8186-bf12-fd1a79a687d5

6/7

30.11.2025, 20:08

Лайфкодинг SQL

таблице будет равно сумме строк из таблиц A и B, но

без дубликатов из A, то есть 50 строк + 10 строк -

количество общих строк между таблицами.

Предположим, что у них нет общих строк, тогда

максимальное количество строк будет 60. Если есть

общие строки, то количество строк будет меньше.

© 2023 —2025 Вадим Новосёлов

Ютуб канал

Телеграм канал

https://gernar.ru/plus/questions/14bee738-d69b-8186-bf12-fd1a79a687d5

7/7





